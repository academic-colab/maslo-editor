<html>
<head>
	<link type="text/css" href="css/maslo-theme/jquery-ui-1.8.16.custom.css" rel="stylesheet" /> 
	<link type="text/css" href="css/jquery.cleditor.css" rel="stylesheet" />
	<link type="text/css" href="css/foundation.css" rel="stylesheet" />
	<link type="text/css" href="css/screen.css" rel="stylesheet" />
	<title>MASLO - Edit Project</title>
</head>
<body>
	<header>
	<h3><a href="index.html">My Content Packs</a> > <span id="proj"></span></h3>
	<div class="extra"><a href="#" onclick="help()">Help</a><img src="icons/maslo_icon_logo.png" /></div>
	</header>

	<div id="toc"></div>

	<div class="action">
		<a class="alt nice small radius blue button" href="">+ Add Content</a>
		<div class="alt">
			<input type="text" length="10" />
			<button type="button">OK</button>
			<button type="button" class="cancel">Cancel</button>
		</div>
		<button type="button" class="nice small radius blue button">Publish</button>
		<button type="button" class="nice small radius blue button" id="preview">Preview</button>
		<div class="clear"></div>
	</div>

<!------------------- DIALOGS --------------------- -->

<div id="dialog-add" style="display: none" title="Add Content">
	<table>
		<tbody>
			<tr>
				<td><input type="file" id="upload" style="display: none" />
					<!-- this button sends any click to the hidden
					     file input element -->
					<button class="alt nice small radius blue button" onclick="$('#upload').click()">Upload</button></td>
				<td>
					<img src="icons/image.png" height="16" width="16"/>
					Image:&nbsp;png,&nbsp;jpg,&nbsp;gif,&nbsp;tiff<br />
					<img src="icons/audio.png" height="16" width="16"/>
					Audio:&nbsp;mp3,&nbsp;wav,&nbsp;aiff<br />
					<img src="icons/video.png" height="16" width="16"/>
					Video:&nbsp;mp4,&nbsp;avi,&nbsp;mov
				</td>
			</tr>
			<tr>
				<td><button class="alt nice small radius blue button" id="btnCreate" type="button">Create Text</button></td>
				<td>
					<img src="icons/text.png" height="16" width="16"/>
					Write new, or copy and paste
				</td>
			</tr>
			<tr>
				<td><button class="alt nice small radius blue button" id="btnQuiz" type="button">Create Quiz</button></td>
				<td>
					<img src="icons/quiz.png" height="16" width="16"/>
					Questions, answer, hints
				</td>
			</tr>
		</tbody>
	</table>
	<form class="quiz" style="display:none" action="quiz.html" method="GET">
		<input type="text" name="title" />
		<input type="hidden" name="id" />
		<input type="hidden" name="project" />
		<input type="submit" value="Create" disabled="disabled" />
	</form>
</div>


<script type="text/javascript" src="AIRAliases.js"></script>
<script type="text/javascript" src="js/json2.js"></script>
<script type="text/javascript" src="js/jquery-1.6.1.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.14.custom.min.js"></script>
<script type="text/javascript" src="js/jquery.watermark.min.js"></script>
<script type="text/javascript" src="js/jquery.cleditor.js"></script>
<script type="text/javascript" src="js/param.js"></script>
<script type="text/javascript" src="js/files.js"></script>
<script type="text/javascript" src="js/urldecode.js"></script>
<script type="text/javascript" src="js/content.js"></script>
<script type="text/javascript" src="js/filecache.js"></script>
<script type="text/javascript" src="js/manifest.js"></script>
<script type="text/javascript" src="js/help.js"></script>
<script type="text/javascript">
var gPageParams = queryParameters(document.location.search);
gPageParams.path = air.File.applicationStorageDirectory.nativePath +
	air.File.separator + gPageParams.name;
var gManifest;

$(document).ready(function() {
	// set project name in breadcrumb
	$('#proj').text(gPageParams.name.toString());

	// load manifest, render table of contents
	gManifest = new Manifest(gPageParams.path);
	gManifest.render($('#toc'));

	$('form.quiz input[type="text"]').watermark('Name of Quiz');
	$('form.quiz input[type="text"]').keyup(function() {
		$('form.quiz input[type="submit"]').attr('disabled', $(this).val() == '');
	});

	$('#preview').click(function() {
		window.location = 'preview.html?name=' + gPageParams.name;
	});

	$('.action a.alt').click(function() {
		$('#dialog-add').dialog({
			autoOpen: true,
			modal: true,
			width: 450,
			position: 'top',
			buttons: {
				"Cancel": function() { 
					$(this).dialog("close"); 
				} 
			}
		});
		return false;
	});
	$('#upload').click(function() {
		chooseFile(function(e) {
			var content = Content.FromImport(gPageParams.path, 'Untitled', e.target.url);
			gManifest.addContent(content);
			// the upload button is inside #dialog-add
			$('#dialog-add').dialog("close");
		});
	});

	$('#btnCreate').click(function() {
		var content = new Text(gPageParams.path, 'Untitled Document');
		gManifest.addContent(content);
		// the create text button is inside #dialog-add
		$('#dialog-add').dialog("close");
	});

	$('#btnQuiz').click(function() {
		$('form.quiz').toggle();
	});

	$('form.quiz').submit(function(event) {
		var content = new Quiz(gPageParams.path,
			$('form.quiz input[name="name"]').val());
		gManifest.addContent(content);

		// add hidden form variables to orient the quiz screen
		$(this).find('input[type="id"]').val(content.id);
		$(this).find('input[type="proj"]').val(gPageParams.name);

		return true;
	});
});
</script>
</html>
